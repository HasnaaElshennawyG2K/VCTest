let
    Source = Sql.Database(".", "statistics", [Query="SELECT gender.Object_id, gender.genderSoftBiometricsValueID--, gender.GenderOccDate#(lf)--, age.ageSoftBiometricsValueID--, age.ageOccDate#(lf), dateadd(HOUR,1,(SELECT Max(v) FROM (VALUES (gender.GenderOccDate)/*, (age.ageOccDate)*/) AS value(v))) [MaxOccDate]#(lf)FROM(#(lf)#(tab)select Object_id, genderSoftBiometricsValueID, MAX(genderOccDate) GenderOccDate#(lf)#(tab)FROM(#(lf)#(tab)#(tab)SELECT b.Object_id#(lf)#(tab)#(tab)--, b.SoftBiometricsTypeID#(lf)#(tab)#(tab), b.OccuranceDate genderOccDate#(lf)#(tab)#(tab), ISNULL(b.SoftBiometricsValueID, -99) as genderSoftBiometricsValueID#(lf)#(tab)#(tab)FROM [T_SoftBiomertics] b WITH (NOLOCK)#(lf)#(tab)#(tab)WHERE B.SoftBiometricsTypeID = (SELECT MAX([SoftBiometricsTypeID]) FROM [dbo].[LT_SoftBiometricsType] WHERE Title = 'GenderXovis')#(lf)#(tab)) nn#(lf)#(tab)GROUP BY Object_id, genderSoftBiometricsValueID#(lf)) gender #(lf)/*RIGHT JOIN (#(lf)#(tab)SELECT Object_id, /*SoftBiometricsTypeID,*/ ageSoftBiometricsValueID, MAX(ageOccDate) ageOccDate#(lf)#(tab)FROM(#(lf)#(tab)#(tab)SELECT b.Object_id#(lf)#(tab)#(tab), ISNULL(b.SoftBiometricsValueID, -99) as ageSoftBiometricsValueID#(lf)#(tab)#(tab), b.OccuranceDate ageOccDate#(lf)#(tab)#(tab)FROM [updated_Statistics].[dbo].[T_SoftBiomertics] b WITH (NOLOCK)#(lf)#(tab)#(tab)WHERE B.SoftBiometricsTypeID = (SELECT MAX([SoftBiometricsTypeID]) FROM [dbo].[LT_SoftBiometricsType] WHERE Title = 'Age')#(lf)#(tab)) nn#(lf)#(tab)GROUP BY Object_id, ageSoftBiometricsValueID#(lf)) age#(lf)ON gender.object_id = age.object_id*/"])
in
    Source